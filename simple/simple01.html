<!doctype html>
<html lang="en">
<meta charset="utf-8">

<head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <script type="text/javascript">
        var network = {
            blockchain: "cosmos",
            chainId: "cosmoshub-2"
        };

        function login() {
            // identity = {
            //     account: "iaa1sgt3cjh3zgywk0vpsvmaay09ljqf8md37ffwgk",
            //     blockchain: "cosmos",
            //     chainId: "cosmoshub-2"
            // }
            mathExtension.getIdentity(network).then(identity => {
                document.getElementById("loginDiv").innerHTML = JSON.stringify(identity);
                console.log(identity);
            }).catch(e => {
                console.log(e);
            })
        }
        function logout() {
            mathExtension.forgetIdentity().then(response => {
                console.log(response);
            }).catch(e => {
                console.log(e);
            })
        }
        function signTransaction() {
            // Transfer
            var transaction = {
                from: "cosmos1njg8uq4ek9y9fvgw59t8qdtrka8tz0aef5gnk4",
                chain_id: "cosmoshub-2",
                account_number: 1756,
                sequence: 3,
                fees: {
                    denom: "uatom",
                    amount: 500
                },
                gas: 20000,
                memo: "",
                type: "transfer",
                msg: {
                    to: "cosmos1njg8uq4ek9y9fvgw59t8qdtrka8tz0aef5gnk4",
                    coins: {
                        denom: "uatom",
                        amount: 100000
                    }
                }
            };
            // Delegate
            /*
            var transaction = {
                from: "cosmos1njg8uq4ek9y9fvgw59t8qdtrka8tz0aef5gnk4",
                chain_id: "cosmoshub-2",
                account_number: 1756,
                sequence: 3,
                fees: {
                    denom: "uatom",
                    amount: 500
                },
                gas: 20000,
                memo: "",
                type: "delegate",
                msg: {
                    validator_addr: "cosmosvaloper1zp6kg7qlmztyw2km2af4z5ruz5vn04cp9npe79",
                    amount: {
                        denom: "uatom",
                        amount: 1000000
                    }
                }
            };
            */
            // Undelegate
            /*
            var transaction = {
                ...,
                type: "undelegate",
                msg: {
                    validator_addr: "cosmosvaloper1zp6kg7qlmztyw2km2af4z5ruz5vn04cp9npe79",
                    amount: {
                        denom: "uatom",
                        amount: 1000000
                    }
                }
            };
            // more
            // https://github.com/irisnet/irisnet-crypto/blob/develop/chains/cosmos/stake.js
            */
            // 请求插件签名
            mathExtension.requestSignature(transaction, network).then(signedTransaction => {
                console.log(signedTransaction);
                document.getElementById("signatureDiv").innerHTML = JSON.stringify(signedTransaction);
            }).catch(e => {
                console.log(e);
            })
        }
    </script>
</head>

<body>
    <div id="loginDiv"></div></br>
    <button type="button" onclick="login()">Login</button></br></br>
    <button type="button" onclick="logout()">Logout</button></br>
    <div id="signatureDiv"></div></br>
    <button type="button" onclick="signTransaction()">Other Transaction</button>
</body>

</html>